<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../css/signIn.css" type="text/css" >
    <link rel="stylesheet" href="../css/reset%20.css" type="text/css">
    <link rel="stylesheet" type="text/css" href="../css/verify.css">
</head>
<body>
<div class="top">
    <div class="top-center">
        <span class="fav">
            <i></i>
            收藏网站
        </span>
        <div class="a"><span>您好！欢迎来到商城！</span>
            <a href="logIn.html">[登录]</a>
            <a href="#">[注册]</a>
        </div>

    </div>
</div>

<div class="logo">
    <div class="log">
        <a href="#">
            <img src="../img/zhongjiuloginlog.png" alt="" height="60">
        </a>
        <b>欢迎注册</b>
    </div>
</div>

<div class="denglu">
    <span>我已经注册，现在就 <a href="logIn.html">登录</a></span>
</div>

<div class="mc">
    <form action="" id="form">
        <div class="form">
            <div class="item">
                <span class="label">手机号码：</span>
                <div class="f1 item-ifo">
                    <div class="shouji">
                        <input type="text" id="callphone" class="text">
                        <i id="i-name"></i>
                    </div>
                </div>
                <div class="hidden yin" id="phoneHidden">
                <p class="hidden-a" id="phone-1">请输入手机号码</p>
                    <p id="phone-2" class="hid">请输入正确手机号</p>
            </div>
            </div>
            <div class="huadong">
                <span class="id">滑块验证：</span>
                <div class="row">
                    <div class="col-md-offset-4 col-md-4">
                        <div id="mpanel1" ></div>
                    </div>
                </div>
            </div>
            <div class="item">
                <span class="label">请设置密码：</span>
                <div class="f1 item-ifo">
                    <div class="shouji">
                        <input type="password" id="password" class="text">
                        <i id="i-name-1"></i>
                    </div>
                </div>
                <div class="hidden yin" id="passHidden">
                <p class="hidden-a lin" id="pass-1">6-20位字符，可使用字母、数字或符号的组合,，不建议使用纯字母、纯数字、纯符号</p>
                    <p id="pass-2" class="hid">密码长度只能在6-20位之间不包含空格</p>
            </div>
            </div>
            <div class="item">
                <span class="label">请确认密码：</span>
                <div class="f1 item-ifo">
                    <div class="shouji">
                        <input type="password" id="password-1" class="text">
                        <i id="i-name-2"></i>
                    </div>
                </div>
                <div class="hidden yin" id="passHidden1">
                <p class="hidden-a" id="pass-3">请再次输入密码</p>
                <p class="hidden-a hid" id="pass-4">两次输入密码不一致</p>
            </div>
            </div>
            <div class="item" id="yanzheng">
                <span class="label">手机验证码：</span>
                <div class="f1 item-ifo " id="yz">
                    <div class="shouji">
                        <input type="text" id="password-3" class="text">
                        <i id="i-name-3"></i>
                    </div>
                </div>

            <div class="hidden  " id="aa2">
                <p class="hidden-a" >获取验证码</p>
            </div>
            </div>
            <div class="duoxuan">
                <input type="checkbox">
                <span>我已经阅读并同意《 <a href="#">用户注册协议</a> 》</span>
            </div>
            <div id="bn"></div>
        </div>
    </form>
</div>
<div class="foot">
    <div class="copy"><p>Copyright©2004-2015   中酒网  版权所有</p></div>
</div>
<script src="http://cdn.bootcss.com/jquery/1.11.0/jquery.min.js" type="text/javascript"></script>
<script>window.jQuery || document.write('<script src="../js/jquery-1.11.0.min.js"><\/script>')</script>
<script type="text/javascript" src="../js/verify.js" ></script>
<script>
    var phone, password,password1,phoneHidden,passHidden,passHidden1,bn;
    var bool=false;
    init();
    function init() {
        $('#mpanel1').slideVerify({
            type : 1,		//类型
            vOffset : 5,	//误差量，根据需求自行调整
            barSize : {
                width : '270px',
                height : '34px'
            },
            ready : function() {
            },
            success : function() {
                bool=true;
            },
            error : function() {
            }

        });
        phone=document.getElementById("callphone");
        password=document.getElementById("password");
        password1=document.getElementById("password-1");
        phoneHidden=document.getElementById("phoneHidden");
        passHidden=document.getElementById("passHidden");
        passHidden1=document.getElementById("passHidden1");
        phone.addEventListener("focus",focusHandler);
        password.addEventListener("focus",passFocusHandler);
        password1.addEventListener("focus",focusPassHandler);
        phone.addEventListener("blur",blurHandler);
        password.addEventListener("blur",passBlurHandler);
        password1.addEventListener("blur",blurPassHandler);
        bn=document.getElementById("bn");
        bn.addEventListener("click",clickHandler);
    }
//正则验证
        function focusHandler(e) {
            phoneHidden.style.display="block";
        }
        function passFocusHandler(e) {
            passHidden.style.display="block";
        }
        function focusPassHandler(e) {
            passHidden1.style.display="block";
        }
        function blurHandler(e) {
           var call=document.getElementById("phone-1");
           var call1=document.getElementById("phone-2");
           var tel=/^1[34578]\d{9}$/;
           if(phone.value.length===0){
               bool=false;
               call.style.color="#e76b3c";
               phoneHidden.style.backgroundColor="#ffebeb";
               phoneHidden.style.borderColor="#ffbdbe";
           }
           else if(!tel.test(phone.value)){
                bool=false;
               call.style.display="none";
               call1.style.display="block";
               call1.style.color="#e76b3c";
               phoneHidden.style.backgroundColor="#ffebeb";
               phoneHidden.style.borderColor="#ffbdbe";
           }else{
               phoneHidden.style.display="none";
               bool=true
           }
           }
        function passBlurHandler(e) {
            var pass=document.getElementById("pass-1");
            var pass1=document.getElementById("pass-2");
            var mima=/^([0-9a-zA-Z]{6,20})$/;
            /*if(phone.value.length===0){
                bool=false;
                call.style.color="#e76b3c";
                phoneHidden.style.backgroundColor="#ffebeb";
                phoneHidden.style.borderColor="#ffbdbe";
            }
            else */
                if(!mima.test(password.value)){
                bool=false;
                    pass.style.display="none";
                    pass1.style.display="block";
                    pass1.style.color="#e76b3c";
                    passHidden.style.backgroundColor="#ffebeb";
                    passHidden.style.borderColor="#ffbdbe";
            }else{
                    passHidden.style.display="none";
                bool=true
            }
        }
        function blurPassHandler(e) {
            var pass3=document.getElementById("pass-3");
            var pass4=document.getElementById("pass-4");
            if(password1.value!==password.value){
                bool=false;
                pass3.style.display="none";
                pass4.style.display="block";
                pass4.style.color="#e76b3c";
                passHidden1.style.backgroundColor="#ffebeb";
                passHidden1.style.borderColor="#ffbdbe";
            }else{
                passHidden1.style.display="none";
                bool=true
            }
        }



        function clickHandler(e) {
            if(!bool) return;
          var username=phone.value;
          var passWord=password.value;
            var obj={username:username,password:passWord,type:2};
            ajax(JSON.stringify(obj));
            console.log(obj)
        }

//ajax
    function ajax(data) {
        var xhr=new XMLHttpRequest() || new ActiveXObject("Microsoft,XMLHTTP");
        xhr.open("post","http://localhost:1005");
        xhr.send(data);
        xhr.onreadystatechange=function () {
            if(xhr.readyState===4){
                if(xhr.status===200){
                    window.location.href="logIn.html";
//                    console.log(JSON.parse(this.response))
                }else {
                    alert("失败")
                }
            }
        }
    }


</script>
</body>
</html>